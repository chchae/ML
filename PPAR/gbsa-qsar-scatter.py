import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
import seaborn as sns


df = pd.DataFrame( [ ['64742-47-8',0,0],
['68476-85-7',0,0],
['7440-22-4',0,0],
['7440-50-8',0,0],
['139-33-3',-36.4,2.0],
['18472-51-0',-74.0,3.7],
['103-23-1',-53.2,3.6],
['27519-02-4',-68.4,3.1],
['8003-34-7',-81.6,4.2],
['66230-04-4',-39.8,4.6],
['51-03-6',-65.1,3.8],
['7173-51-5',-70.3,],
['2915-53-9',-75.7,4.0],
['56073-10-0',0,4.9],
['80844-07-1',-72.9,4.2],
['1934-21-0',-54.4,4.0],
['91465-08-6',-78.0,4.5],
['90035-08-8',-80.6,5.4],
['173584-44-6',-75.7,5.9],
['67485-29-4',-76.6,3.8],
['52315-07-8',-79.5,3.7],
['67375-30-8',-72.6,3.7],
['39515-40-7',-74.7,4.1],
['51630-58-1',-70.6,4.6],
['68359-37-5',-78.5,4.2],
['52645-53-1',-83.7,3.5],
['65733-16-6',-56.4,3.9],
['110-27-0',-62.8,4.1],
['10453-86-8',-39.8,3.7],
['28434-01-7',-75.5,3.7],
['26002-80-2',-65.7,4.0],
['123-03-5',-64.2,3.0],
['68391-01-5',-74.7,3.9],
['144171-61-9',-75.7,5.9],
['82657-04-3',-75.1,4.0],
['116714-46-6',-65.7,5.7],
['7696-12-0',-68.6,2.6],
['28434-00-6',-64.4,4.2],
['52918-63-5',-65.4,4.3],
['584-79-2',-62.8,4.2],
['72963-72-5',-70.6,3.4],
['64628-44-0',-68.2,4.3],
['23031-36-9',-61.6,3.9],
['240494-70-6',-69.5,2.7],
['118712-89-3',-60.2,2.8],
['136-45-8',-32.6,3.9],
['201593-84-2',-61.6,4.7],
['60207-90-1',-60.8,5.9],
['52304-36-6',-78.5,3.3],
['143-07-7',-65.9,4.5],
['333-41-5',-49.4,3.5],
['31218-83-4',-48.8,3.9],
['3734-33-6',-29.2,4.3],
['2921-88-2',-55.4,3.2],
['64359-81-5',-65.7,3.5],
['26530-20-1',-56.1,3.7],
['5836-29-3',-46.8,3.7],
['8028-48-6',-60.7,4.4],
['119515-38-7',-44.7,3.6],
['334-48-5',-39.1,4.5],
['107534-96-3',-55.4,4.3],
['122-40-7',-48.6,5.1],
['55406-53-6',-68.2,3.4],
['120068-37-3',-53.9,4.0],
['122-14-5',-47.0,3.5],
['111988-49-9',-58.8,3.8],
['16252-70-0',0,3.7],
['106-23-0',-42.4,3.3],
['8000-29-1',0,3.3],
['134-62-3',-54.7,4.8],
['330-54-1',-70.6,3.9],
['114-26-1',-50.7,3.2],
#['94-13-3',-17.6,4.4],
['25265-71-8',-46.5,2.6],
['127-90-2',-64.1,2.0],
['34590-94-8',-39.8,3.5],
['62-73-7',-44.5,2.5],
['106-24-1',-60.2,3.2],
['2893-78-9',-34.7,2.7],
['110-98-5',-46.3,2.0],
['123-66-0',-64.2,3.3],
['78-70-6',-38.8,4.4],
['77-92-9',-6.9,],
#['24634-61-5',-73.7,2.2],
['3391-86-4',-41.8,3.7],
['111-76-2',-32.8,2.5],
['6440-58-0',-38.6,3.2],
['10605-21-7',-50.7,4.3],
['123-92-2',-30.2,2.8],
['120068-79-3',-43.6,3.4],
['532-32-1',-34.7,3.6],
['90-43-7',-48.5,2.7],
['118-52-5',-39.1,1.7],
['99-76-3',-38.9,4.6],
['2216-51-5',-41.8,3.0],
['122-99-6',-37.7,3.8],
['104-55-2',-38.4,3.0],
['148-79-8',-39.8,3.4],
['5989-27-5',-35.3,3.7],
['107-41-5',-33.5,2.7],
['69-72-7',-12.3,3.4],
['138-86-3',-33.5,3.7],
['56539-66-3',-34.7,1.8],
['52-51-7',-55.4,3.0],
['110-54-3',-27.2,2.1],
['100-51-6',-39.5,3.5],
['10222-01-2',-26.8,2.5],
['65-85-0',-28.5,3.1],
['96-29-7',-17.6,3.0],
['56-81-5',-26.4,2.0],
['107-88-0',-13.5,2.1],
['1330-20-7',-34.2,3.6],
['79-33-4',-14.9,2.7],
['26172-55-4',-33.3,2.9],
['55965-84-9',-33.7,2.9],
['2634-33-5',-39.8,4.6],
['57-55-6',-16.2,2.4],
['108-88-3',-27.1,3.2],
['1302-78-9',0,1.5],
['26172-54-3',-74.7,2.8],
['2682-20-4',-36.9,2.8],
['25322-68-3',0,1.9],
['67-63-0',-54.7,1.8],
['10043-35-3 ',-12.1,1.7],
['3811-73-2',-29.2,2.5],
['12069-69-1',0,2.0],
['144-55-8',-16.8,2.0],
['106-97-8',-33.5,1.7],
# ['1330-43-4',-81.6,1.1],
['8030-30-6',0,1.7],
['64-19-7',-28.5,2.2],
['64-17-5',-12.3,1.9],
['64-18-6',-39.5,1.7],
['7722-84-1',-6.4,1.5],
['1317-38-0',0,1.8],
['7631-86-9',-8.9,1.9],
['50-00-0',-2.8,1.6],
['7757-83-7',-26.0,1.6],
['1317-39-1',0,0],
['7681-52-9',-3.4,1.2],
['13463-41-7',0,0],
['68424-85-1',-72.8,3.9],
['27083-27-8',-55.6,3.3],
['7758-99-8',0,1.8],
['68439-46-3',-21.4,2.3],
['85409-23-0',-76.2,3.7],
['85409-22-9',-62.1,4.0],
['71-23-8',-16.9,2.1],
['1310-73-2',3.9,1.3],
['7440-66-6',0,1.1],
['8000-28-0',-30.7,4.4],
['7647-14-5',0,1.2],
['15630-89-4',-0.1,1.9],
['12125-02-9',-4.8,1.1],
['37222-66-5',0,2.2],
['2372-82-9',-53.4,2.3],
['64-02-8',-18.0,2.0],
['8001-54-5',-75.5,3.9],
['14701-21-4',0,1.2],
['68956-79-6',-74.8,3.7],
['143-19-1',-62.5,4.1],
['79-21-0',-12.0,2.3],
['27668-52-6',0,3.2],
['1344-09-8',0,1.7],
['7757-82-6',0,1.8],
['9012-76-4',0,2.9],
['7440-70-2',0,0.9],
['866-84-2',0.4,2.5],
['1314-13-2',0,1.9],
['63391-01-5',-72.8,3.9],
['8000-34-8',-31.3,4.6],
['1401-55-4',0,4.5],
['9012-72-0',-62.9,3.6],
['518-82-1',-45.9,3.5],
['1317-70-0',0,1.6],
['68916-73-4',-93.6,4.2],
['8007-11-2',-46.2,3.9],
['13463-67-7',0,1.6],
['497-19-8',-1.8,1.9],
['58249-25-5',-42.1,3.5],
['93820-33-8',-65.3,4.3],
['71060-57-6',-39.5,3.3],
['7782-63-0',0,1.8],
['2665-13-6',-50.8,1.7],
['14697-50-8',-45.2,1.8],
['8007-80-5',-32.0,4.6],
['91745-97-0',-33.4,3.1],
['8015-91-6',-37.0,3.0],
['8002-09-3',-31.9,3.4],
['54406-48-3',-58.1,3.1],
['128-37-0',-38.6,3.1],
['63231-67-4',0,1.9],
['260359-57-5',-62.6,4.2],
['8001-30-7',-62.5,4.5],
['5949-29-1',-9.1,2.9],
['3012-65-5',-26.8,2.7],
['57-48-7',-41.7,3.1],
['105827-78-9',-48.7,4.5],
['54-21-7',-29.3,3.3],
['231937-89-6',-62.6,4.2],
['1166-46-7',-51.9,2.6],
['84030-88-4',-62.6,4.2],
['519-02-8',-40.2,2.5],
['123997-26-2',0,6.0],
['70288-86-7',0,5.5],
['3766-81-2',-33.0,4.3],
['188023-86-1',-78.1,4.0],
['108-62-3',-31.9,1.6],
['107-21-1',-23.0,1.9],
['111-30-8',-24.8,2.3],
['770-35-4',-28.6,3.8],
['6004-24-6',0,2.9],
['10377-60-3',-11.9,1.4],
['1321-23-9',-40.7,3.3],
['3380-34-5',-39.5,4.1],
['4719-04-4',-39.6,1.9],
['126-06-7',-28.3,2.4],
#['4418-26-2',-6.9,4.5],
['35691-65-7',-24.2,1.6],
['137-26-8',-40.3,1.7],
['4299-07-4',-41.8,3.6],
['13590-97-1',-47.1,3.4],
['59-50-7',-44.0,3.6],
['61789-71-7',-73.7,4.8],
['43121-43-3',-54.1,5.1],
['29911-28-2',-34.0,3.0],
['94361-06-5',-41.6,4.8],
['67564-91-4',-59.9,4.4],
['131860-33-8',-71.3,4.6],
['67-64-1',-7.4,2.0],
['109-60-4',-23.1,2.9],
['123-86-4',-27.4,3.2],
['71-36-3',-22.6,2.7],
['9004-70-0',0,2.8],
['141-78-6',-15.8,2.8],
['25869-00-5',-4.8,1.4],
['7647-15-6',0,1.2],
['14915-37-8',-23.1,2.3],
['137-30-4',-20.1,1.6],
['122454-29-9',-38.7,4.5],
# ['63449-39-8',-92.2,2.1],
['12122-67-7',-17.2,1.7],
['7727-43-7',0,1.8],
['86347-14-0',-33.4,3.7],
['1777-82-8',-34.1,3.9],
['1305-62-0',3.9,1.3],
['1310-58-3',3.9,1.3],
['10543-57-4',-39.6,2.4],
['617-48-1',-21.7,2.2],
['84133-50-6',-51.0,3.3],
['74-98-6',-4.1,1.7],
['5538-95-4',-50.6,2.9],
['1306-06-5',0,2.1],
['9002-92-0',-50.8,3.3],
['2530-87-2',-29.5,2.7],
['480-40-0',-45.0,4.2],
['1332-37-2',0,1.3],
['8047-15-2',0,4.0],
['2086-83-1',-64.8,4.0],
['8000-25-7',-26.9,1.9],
['90045-43-5',-32.6,4.1],
['6317-18-6',-28.7,1.8],
['7664-38-2',0,2.1],
['144538-83-0',-23.9,2.9],
['7790-92-3',-10.8,1.6],
['1310-53-8',0,1.7],
['111-40-0',-23.9,1.3],
['8023-84-5',-42.8,3.2],
['8006-90-4',-34.6,3.2],
['8001-79-4',0,4.6],
['4075-81-4',-23.2,2.3],
['55-63-0',-28.5,1.9],
['14548-60-8',-35.1,3.9],
['113507-06-5',0,6.4],
['110-44-1',-23.4,2.2],
['51229-78-8',-22.5,2.2],
['11141-17-6',0,4.9],
['7631-99-4',-11.9,1.4],
['112-34-5',-38.1,2.3],
['166412-78-8',-72.3,4.3],
['2527-66-4',-35.2,3.1],
['7786-30-3',0,1.1],
['89-83-8',-46.5,3.9],
['1321-94-4',-42.7,3.0],
['89415-87-2',-31.9,3.0],
['70445-33-9',-41.5,3.4],
['149-30-4',-24.7,2.4],
['265647-11-8',-0.1,1.7],
['28211-04-3',0,3.0],
['872-50-4',-17.4,2.0],
['121-44-8',-24.9,2.0],
['10380-28-6',-26.7,2.6],
['10043-35-3',-5.0,1.7],
['131341-86-1',-37.9,3.4],
['15782-06-6',-51.7,4.6],
['86347-14-1',-36.2,3.7] ] )

print (df.shape)
df = df.fillna(0)
df = df.drop( df[ df[1] == 0 ].index )
df = df.drop( df[ df[2] == 0 ].index )
print (df.shape)

x = df[1].to_numpy()
y = df[2].to_numpy()
#x = np.array( [ -46, -57, -83 ]  )
#y = np.array( [ 5, 7, 9 ]  )
#print(x)
#print(y)

plt.figure( figsize=(6, 6) )
plt.title( 'MM-GBSA vs QSAR' )
plt.xlabel( 'MM-GBSA energy' )
plt.ylabel( 'QSAR pChemblValue' )
#plt.xlim( -100, 0 )
#plt.ylim( 0, 10 )
plt.scatter( x, y, s=5 )

#sns.regplot( x, y, fit_reg=True )
m, b = np.polyfit( x, y, 1 )
r = np.corrcoef( x, y )[ 0, 1 ]
plt.plot( x, m * x + b,  c='k', lw=1, ls='--' )
msg = 'y = %.4f x + %.1f, r2=%.2f' % ( m, b, r*r )
plt.text( -30, 3, msg, fontsize=8 )


plt.savefig( 'GBSA-QSAR.png', dpi=300 )



